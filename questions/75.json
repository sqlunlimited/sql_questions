{
  "title": "Calculate Balance and Uncleared Funds per Customer",
  "difficulty": "Medium",
  "description": "You are working as a Data Engineer at a bank that maintains all customer transactions in a table named Transactions. Write an SQL query to calculate the Balance and Uncleared Funds for each customer based on the following conditions.\n\nBalance: Include only transactions where Status = 'Pass'. For Credit, add the Amount. For Debit, subtract the Amount.\nUncleared Funds: Include only transactions where Status = 'Fail'. Consider only Credit transactions (since failed Debits do not affect uncleared funds). Sum their Amount.",
  "schema": "CREATE TABLE Transactions (TransactionID INTEGER, CustomerID INTEGER, Transaction TEXT, Amount INTEGER, Status TEXT);\nINSERT INTO Transactions VALUES (1, 1, 'Credit', 1000, 'Pass');\nINSERT INTO Transactions VALUES (2, 1, 'Debit', 200, 'Pass');\nINSERT INTO Transactions VALUES (3, 1, 'Credit', 500, 'Fail');\nINSERT INTO Transactions VALUES (4, 1, 'Credit', 600, 'Pass');\nINSERT INTO Transactions VALUES (5, 1, 'Debit', 1200, 'Pass');\nINSERT INTO Transactions VALUES (6, 2, 'Debit', 200, 'Fail');\nINSERT INTO Transactions VALUES (7, 2, 'Credit', 100, 'Pass');\nINSERT INTO Transactions VALUES (8, 2, 'Debit', 50, 'Pass');",
  "expectedResult": {
    "columns": ["CustomerID", "Balance", "Uncleared Funds"],
    "values": [
      [1, 200, 500],
      [2, 50, 0]
    ]
  },
  "hint": "",
  "contributor": {
    "name": "Janak Tyage",
    "link": "https://linkedin.com/in/janak-tyagi/"
  }
}
