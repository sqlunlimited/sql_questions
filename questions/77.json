{
  "title": "Customer Purchase Summary",
  "difficulty": "Easy",
  "description": "Write a SQL query to find the first and last purchase date for each customer. Include customers who have never made a purchase (show NULL for their dates).",
  "schema": "CREATE TABLE customers (customer_id INTEGER);\nINSERT INTO customers VALUES (1);\nINSERT INTO customers VALUES (2);\n\nCREATE TABLE sales (customer_id INTEGER, purchase_date TEXT);\nINSERT INTO sales VALUES (1, '2025-01-10');\nINSERT INTO sales VALUES (1, '2025-03-15');",
  "expectedResult": {
    "columns": ["customer_id", "first_purchase", "last_purchase"],
    "values": [
      [1, "2025-01-10", "2025-03-15"],
      [2, null, null]
    ]
  },
  "hint": "Use LEFT JOIN to include all customers, then use MIN() and MAX() to find first and last purchase dates. Don't forget GROUP BY!",
  "testCases": [
    {
      "name": "Basic Test - Two Customers",
      "visible": true,
      "schema": "CREATE TABLE customers (customer_id INTEGER);\nINSERT INTO customers VALUES (1);\nINSERT INTO customers VALUES (2);\n\nCREATE TABLE sales (customer_id INTEGER, purchase_date TEXT);\nINSERT INTO sales VALUES (1, '2025-01-10');\nINSERT INTO sales VALUES (1, '2025-03-15');",
      "expectedResult": {
        "columns": ["customer_id", "first_purchase", "last_purchase"],
        "values": [
          [1, "2025-01-10", "2025-03-15"],
          [2, null, null]
        ]
      }
    },
    {
      "name": "Hidden Test - Multiple Purchases",
      "visible": false,
      "schema": "CREATE TABLE customers (customer_id INTEGER);\nINSERT INTO customers VALUES (1);\nINSERT INTO customers VALUES (2);\nINSERT INTO customers VALUES (3);\n\nCREATE TABLE sales (customer_id INTEGER, purchase_date TEXT);\nINSERT INTO sales VALUES (1, '2025-01-10');\nINSERT INTO sales VALUES (1, '2025-03-15');\nINSERT INTO sales VALUES (1, '2025-05-20');\nINSERT INTO sales VALUES (2, '2025-02-14');\nINSERT INTO sales VALUES (2, '2025-02-14');",
      "expectedResult": {
        "columns": ["customer_id", "first_purchase", "last_purchase"],
        "values": [
          [1, "2025-01-10", "2025-05-20"],
          [2, "2025-02-14", "2025-02-14"],
          [3, null, null]
        ]
      }
    },
    {
      "name": "Hidden Test - All Active Customers",
      "visible": false,
      "schema": "CREATE TABLE customers (customer_id INTEGER);\nINSERT INTO customers VALUES (1);\nINSERT INTO customers VALUES (2);\n\nCREATE TABLE sales (customer_id INTEGER, purchase_date TEXT);\nINSERT INTO sales VALUES (1, '2025-01-01');\nINSERT INTO sales VALUES (2, '2025-01-15');\nINSERT INTO sales VALUES (2, '2025-02-20');",
      "expectedResult": {
        "columns": ["customer_id", "first_purchase", "last_purchase"],
        "values": [
          [1, "2025-01-01", "2025-01-01"],
          [2, "2025-01-15", "2025-02-20"]
        ]
      }
    }
  ],
  "contributor": {
    "name": "Test User",
    "link": "https://www.linkedin.com/in/test"
  }
}
