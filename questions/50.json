{
  "title": "Last 5 Orders per Customer",
  "difficulty": "Medium",
  "description": "Write a SQL query to retrieve the last 5 orders for each customer.",
  "schema": "CREATE TABLE orders (order_id INTEGER, customer_id INTEGER, order_date DATE);\nINSERT INTO orders VALUES (1, 1, '2025-01-01');\nINSERT INTO orders VALUES (2, 1, '2025-02-01');\nINSERT INTO orders VALUES (3, 1, '2025-03-01');",
  "expectedResult": {
    "columns": [
      "order_id",
      "customer_id",
      "order_date"
    ],
    "values": [
      [
        3,
        1,
        "2025-03-01"
      ],
      [
        2,
        1,
        "2025-02-01"
      ],
      [
        1,
        1,
        "2025-01-01"
      ]
    ]
  },
  "hint": "Use ROW_NUMBER() partitioned by customer_id, ordered by order_date DESC, then filter rn <= 5.",
  "contributor": {
    "name": "Linkedin",
    "link": "https://linkedin.com/"
  }
}